{"version":3,"sources":["../../../src/php/strings/str_word_count.js"],"names":["module","exports","str_word_count","str","format","charlist","ctypeAlpha","require","len","length","cl","chr","tmpStr","i","c","wArr","wC","assoc","aC","reg","match","_pregQuote","replace","_getWholeChar","code","charCodeAt","charAt","Error","next","prev","RegExp","search"],"mappings":"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","file":"str_word_count.js","sourcesContent":["module.exports = function str_word_count(str, format, charlist) {\n  //  discuss at: https://locutus.io/php/str_word_count/\n  // original by: Ole Vrijenhoek\n  // bugfixed by: Kevin van Zonneveld (https://kvz.io)\n  // bugfixed by: Brett Zamir (https://brett-zamir.me)\n  // bugfixed by: Brett Zamir (https://brett-zamir.me)\n  //    input by: Bug?\n  // improved by: Brett Zamir (https://brett-zamir.me)\n  //   example 1: str_word_count(\"Hello fri3nd, you're\\r\\n       looking          good today!\", 1)\n  //   returns 1: ['Hello', 'fri', 'nd', \"you're\", 'looking', 'good', 'today']\n  //   example 2: str_word_count(\"Hello fri3nd, you're\\r\\n       looking          good today!\", 2)\n  //   returns 2: {0: 'Hello', 6: 'fri', 10: 'nd', 14: \"you're\", 29: 'looking', 46: 'good', 51: 'today'}\n  //   example 3: str_word_count(\"Hello fri3nd, you're\\r\\n       looking          good today!\", 1, '\\u00e0\\u00e1\\u00e3\\u00e73')\n  //   returns 3: ['Hello', 'fri3nd', \"you're\", 'looking', 'good', 'today']\n  //   example 4: str_word_count('hey', 2)\n  //   returns 4: {0: 'hey'}\n\n  const ctypeAlpha = require('../ctype/ctype_alpha')\n  const len = str.length\n  const cl = charlist && charlist.length\n  let chr = ''\n  let tmpStr = ''\n  let i = 0\n  let c = ''\n  const wArr = []\n  let wC = 0\n  const assoc = {}\n  let aC = 0\n  let reg = ''\n  let match = false\n\n  const _pregQuote = function (str) {\n    return (str + '').replace(/([\\\\.+*?[^\\]$(){}=!<>|:])/g, '\\\\$1')\n  }\n  const _getWholeChar = function (str, i) {\n    // Use for rare cases of non-BMP characters\n    const code = str.charCodeAt(i)\n    if (code < 0xd800 || code > 0xdfff) {\n      return str.charAt(i)\n    }\n    if (code >= 0xd800 && code <= 0xdbff) {\n      // High surrogate (could change last hex to 0xDB7F to treat high private surrogates as single\n      // characters)\n      if (str.length <= i + 1) {\n        throw new Error('High surrogate without following low surrogate')\n      }\n      const next = str.charCodeAt(i + 1)\n      if (next < 0xdc00 || next > 0xdfff) {\n        throw new Error('High surrogate without following low surrogate')\n      }\n      return str.charAt(i) + str.charAt(i + 1)\n    }\n    // Low surrogate (0xDC00 <= code && code <= 0xDFFF)\n    if (i === 0) {\n      throw new Error('Low surrogate without preceding high surrogate')\n    }\n    const prev = str.charCodeAt(i - 1)\n    if (prev < 0xd800 || prev > 0xdbff) {\n      // (could change last hex to 0xDB7F to treat high private surrogates as single characters)\n      throw new Error('Low surrogate without preceding high surrogate')\n    }\n    // We can pass over low surrogates now as the second component in a pair which we have already\n    // processed\n    return false\n  }\n\n  if (cl) {\n    reg = '^(' + _pregQuote(_getWholeChar(charlist, 0))\n    for (i = 1; i < cl; i++) {\n      if ((chr = _getWholeChar(charlist, i)) === false) {\n        continue\n      }\n      reg += '|' + _pregQuote(chr)\n    }\n    reg += ')$'\n    reg = new RegExp(reg)\n  }\n\n  for (i = 0; i < len; i++) {\n    if ((c = _getWholeChar(str, i)) === false) {\n      continue\n    }\n    // No hyphen at beginning or end unless allowed in charlist (or locale)\n    // No apostrophe at beginning unless allowed in charlist (or locale)\n    // @todo: Make this more readable\n    match =\n      ctypeAlpha(c) ||\n      (reg && c.search(reg) !== -1) ||\n      (i !== 0 && i !== len - 1 && c === '-') ||\n      (i !== 0 && c === \"'\")\n    if (match) {\n      if (tmpStr === '' && format === 2) {\n        aC = i\n      }\n      tmpStr = tmpStr + c\n    }\n    if (i === len - 1 || (!match && tmpStr !== '')) {\n      if (format !== 2) {\n        wArr[wArr.length] = tmpStr\n      } else {\n        assoc[aC] = tmpStr\n      }\n      tmpStr = ''\n      wC++\n    }\n  }\n\n  if (!format) {\n    return wC\n  } else if (format === 1) {\n    return wArr\n  } else if (format === 2) {\n    return assoc\n  }\n\n  throw new Error('You have supplied an incorrect format')\n}\n"]}